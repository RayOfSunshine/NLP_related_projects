#### 模型解释

1、分类模型的可解释性 LIME

+ 论文标题：“Why Should I Trust You?” Explaining the Predictions of Any Classifier

+ 背景：我们训练模型用到的数据和实际场景差别较大；评价准则比较局限，不能提现出关心的但难以量化的标准；存在**数据泄露**或者**数据集漂移**，得到的模型也可能并不可靠。需要能够对模型的预测进行解释。

+ 解释一个预测结果：通过文本的或者视觉的方式来呈现样本的具体组成部分跟模型预测结果之间的关系。

+ 一个理想的解释器应该具备：

  + **必须考虑“人是否好理解”**
  + **局部保真性**。完全解释是不可能的，但，我们可以在局部、小范围内进行一些简单的解释。
  + 模型无关的（model-agnostic） 我们的解释器，应该跟具体模型无关，最好是通用的。
  + 提供全局视角，而不是简单的准确率，需要考虑大部分关心的标准

+ **L**ocal **I**nterpretable **M**odel-agnostic **E**xplanations

  + <font color=red>总体思想</font>：原始模型复杂的决策边界，在任意一个样本点的局部范围内，可以视为是线性的。那只要找到这些线性的边界，就可以对模型在该样本点处进行解释了。
  + 构建可解释的数据表示。将原始数据，转化成一组由基本元素构成的**0-1表示**，表示是否出现。
  + 选择一个天然可解释的简单模型。比如**线性模型、决策树**。
  + 局部采样来拟合一个局部线性模型
    + 局部采样：对特征向量进行一些扰动，具体的，随机的对0-1向量中的1进行改变，改变的数量也随机。然后根据这些扰动后的向量，跟原向量的相似度，来使用不同的采样比例。直观上来讲，扰动的少的，采样会更多，扰动大的采样更少。
    + 拟合局部线性模型：希望这个可解释模型能够在**局部**范围内尽可能接近原模型的决策边界，同时控制可解释模型的复杂度。
  + ![截屏2021-07-13 下午4.41.23](https://tva1.sinaimg.cn/large/008i3skNgy1gsfewygz3xj30jt09y40m.jpg)

  + 训练完成后，最终得到的g，只有少数几个最重要的特征，因此解释性、可理解性很强。g的各个w可以可视化出来，看出不同特征的贡献程度。